/home/qlyu/anaconda3/envs/cuda12.1/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/qlyu/AA_peptide/pepland/claude_test/train_large_supervised.py:153: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
============================================================
监督学习训练 - 大规模数据集
============================================================

设备: cuda:0 (物理GPU 2)

配置:
  data_dir: data_large
  batch_size: 32
  hidden_dim: 256
  num_layers: 6
  num_heads: 8
  dropout: 0.1
  learning_rate: 0.0001
  weight_decay: 1e-05
  num_epochs: 20
  max_samples: None

加载数据...
加载数据: data_large/train.csv
  总样本数: 853
  有效样本数: 853
加载数据: data_large/valid.csv
  总样本数: 107
  有效样本数: 107
加载数据: data_large/test.csv
  总样本数: 107
  有效样本数: 107

创建模型...
  模型参数量: 6,651,663

开始训练...
------------------------------------------------------------
训练:   0%|          | 0/27 [00:00<?, ?it/s]/home/qlyu/AA_peptide/pepland/claude_test/train_large_supervised.py:37: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home/qlyu/anaconda3/envs/cuda12.1/lib/python3.11/site-packages/dgl/backend/pytorch/sparse.py:157: FutureWarning: `torch.cuda.amp.autocast_mode._cast(value, dtype)` is deprecated. Please use `torch.amp.autocast_mode._cast(value, 'cuda', dtype)` instead.
  return th.cuda.amp.autocast_mode._cast(
/home/qlyu/anaconda3/envs/cuda12.1/lib/python3.11/site-packages/dgl/backend/pytorch/sparse.py:148: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return th.cuda.amp.autocast(enabled=False)
训练:   4%|▎         | 1/27 [00:01<00:28,  1.09s/it]训练:   7%|▋         | 2/27 [00:01<00:12,  1.94it/s]训练:  11%|█         | 3/27 [00:01<00:07,  3.00it/s]训练:  15%|█▍        | 4/27 [00:01<00:05,  4.12it/s]训练:  19%|█▊        | 5/27 [00:01<00:04,  5.08it/s]训练:  22%|██▏       | 6/27 [00:01<00:03,  5.95it/s]训练:  26%|██▌       | 7/27 [00:01<00:02,  6.70it/s]训练:  30%|██▉       | 8/27 [00:01<00:02,  7.28it/s]训练:  33%|███▎      | 9/27 [00:01<00:02,  7.70it/s]训练:  37%|███▋      | 10/27 [00:02<00:02,  8.23it/s]训练:  41%|████      | 11/27 [00:02<00:01,  8.39it/s]训练:  44%|████▍     | 12/27 [00:02<00:01,  8.60it/s]训练:  48%|████▊     | 13/27 [00:02<00:01,  8.74it/s]训练:  52%|█████▏    | 14/27 [00:02<00:01,  8.62it/s]训练:  56%|█████▌    | 15/27 [00:02<00:01,  8.84it/s]训练:  59%|█████▉    | 16/27 [00:02<00:01,  8.81it/s]训练:  63%|██████▎   | 17/27 [00:02<00:01,  8.77it/s]训练:  67%|██████▋   | 18/27 [00:02<00:01,  8.67it/s]训练:  70%|███████   | 19/27 [00:03<00:00,  8.87it/s]训练:  74%|███████▍  | 20/27 [00:03<00:00,  8.98it/s]训练:  78%|███████▊  | 21/27 [00:03<00:00,  8.98it/s]训练:  81%|████████▏ | 22/27 [00:03<00:00,  9.01it/s]训练:  85%|████████▌ | 23/27 [00:03<00:00,  9.19it/s]训练:  89%|████████▉ | 24/27 [00:03<00:00,  9.37it/s]训练:  93%|█████████▎| 25/27 [00:03<00:00,  9.42it/s]训练:  96%|█████████▋| 26/27 [00:03<00:00,  9.35it/s]训练: 100%|██████████| 27/27 [00:03<00:00,  6.83it/s]
Epoch 1/20: Train Loss=1.0608, Val Loss=0.8958, Time=4.4s
  ✓ 保存最佳模型 (val_loss=0.8958)
训练:   0%|          | 0/27 [00:00<?, ?it/s]训练:   4%|▎         | 1/27 [00:00<00:06,  4.27it/s]训练:   7%|▋         | 2/27 [00:00<00:04,  5.41it/s]训练:  11%|█         | 3/27 [00:00<00:03,  6.29it/s]训练:  15%|█▍        | 4/27 [00:00<00:03,  6.96it/s]训练:  19%|█▊        | 5/27 [00:00<00:02,  7.58it/s]训练:  22%|██▏       | 6/27 [00:00<00:02,  8.00it/s]训练:  26%|██▌       | 7/27 [00:00<00:02,  8.19it/s]训练:  30%|██▉       | 8/27 [00:01<00:02,  8.60it/s]训练:  33%|███▎      | 9/27 [00:01<00:02,  8.62it/s]训练:  37%|███▋      | 10/27 [00:01<00:01,  8.72it/s]训练:  41%|████      | 11/27 [00:01<00:01,  8.97it/s]训练:  44%|████▍     | 12/27 [00:01<00:01,  9.03it/s]训练:  48%|████▊     | 13/27 [00:01<00:01,  9.17it/s]训练:  52%|█████▏    | 14/27 [00:01<00:01,  9.38it/s]训练:  56%|█████▌    | 15/27 [00:01<00:01,  9.20it/s]训练:  59%|█████▉    | 16/27 [00:01<00:01,  9.23it/s]训练:  63%|██████▎   | 17/27 [00:02<00:01,  9.11it/s]训练:  67%|██████▋   | 18/27 [00:02<00:01,  8.94it/s]训练:  70%|███████   | 19/27 [00:02<00:00,  8.70it/s]训练:  74%|███████▍  | 20/27 [00:02<00:00,  8.07it/s]训练:  78%|███████▊  | 21/27 [00:02<00:00,  8.23it/s]训练:  81%|████████▏ | 22/27 [00:02<00:00,  8.50it/s]训练:  85%|████████▌ | 23/27 [00:02<00:00,  8.63it/s]训练:  89%|████████▉ | 24/27 [00:02<00:00,  8.84it/s]训练:  93%|█████████▎| 25/27 [00:02<00:00,  8.78it/s]训练:  96%|█████████▋| 26/27 [00:03<00:00,  8.02it/s]训练: 100%|██████████| 27/27 [00:03<00:00,  8.21it/s]训练: 100%|██████████| 27/27 [00:03<00:00,  8.16it/s]
Epoch 2/20: Train Loss=1.0530, Val Loss=1.0703, Time=3.7s
训练:   0%|          | 0/27 [00:00<?, ?it/s]训练:   4%|▎         | 1/27 [00:00<00:06,  4.12it/s]训练:   7%|▋         | 2/27 [00:00<00:04,  5.88it/s]训练:  11%|█         | 3/27 [00:00<00:03,  6.95it/s]训练:  15%|█▍        | 4/27 [00:00<00:02,  7.82it/s]训练:  19%|█▊        | 5/27 [00:00<00:02,  8.27it/s]训练:  22%|██▏       | 6/27 [00:00<00:02,  7.69it/s]训练:  26%|██▌       | 7/27 [00:00<00:02,  7.66it/s]训练:  30%|██▉       | 8/27 [00:01<00:02,  7.84it/s]训练:  33%|███▎      | 9/27 [00:01<00:02,  7.98it/s]训练:  37%|███▋      | 10/27 [00:01<00:02,  8.11it/s]训练:  41%|████      | 11/27 [00:01<00:01,  8.20it/s]训练:  44%|████▍     | 12/27 [00:01<00:01,  8.36it/s]训练:  48%|████▊     | 13/27 [00:01<00:01,  8.47it/s]训练:  52%|█████▏    | 14/27 [00:01<00:01,  8.60it/s]训练:  56%|█████▌    | 15/27 [00:01<00:01,  8.18it/s]训练:  59%|█████▉    | 16/27 [00:02<00:01,  7.99it/s]训练:  63%|██████▎   | 17/27 [00:02<00:01,  8.13it/s]训练:  67%|██████▋   | 18/27 [00:02<00:01,  8.34it/s]训练:  70%|███████   | 19/27 [00:02<00:00,  8.45it/s]训练:  74%|███████▍  | 20/27 [00:02<00:00,  8.71it/s]训练:  78%|███████▊  | 21/27 [00:02<00:00,  8.90it/s]训练:  81%|████████▏ | 22/27 [00:02<00:00,  8.93it/s]训练:  85%|████████▌ | 23/27 [00:02<00:00,  9.15it/s]训练:  89%|████████▉ | 24/27 [00:02<00:00,  9.29it/s]训练:  93%|█████████▎| 25/27 [00:03<00:00,  9.22it/s]训练:  96%|█████████▋| 26/27 [00:03<00:00,  9.28it/s]训练: 100%|██████████| 27/27 [00:03<00:00,  8.26it/s]
Epoch 3/20: Train Loss=0.9904, Val Loss=1.5760, Time=3.7s
训练:   0%|          | 0/27 [00:00<?, ?it/s]训练:   4%|▎         | 1/27 [00:00<00:09,  2.72it/s]训练:   7%|▋         | 2/27 [00:00<00:05,  4.21it/s]训练:  11%|█         | 3/27 [00:00<00:04,  5.44it/s]训练:  15%|█▍        | 4/27 [00:00<00:03,  6.40it/s]训练:  19%|█▊        | 5/27 [00:00<00:03,  6.97it/s]训练:  22%|██▏       | 6/27 [00:01<00:02,  7.11it/s]训练:  26%|██▌       | 7/27 [00:01<00:02,  7.30it/s]训练:  30%|██▉       | 8/27 [00:01<00:02,  7.57it/s]训练:  33%|███▎      | 9/27 [00:01<00:02,  7.89it/s]训练:  37%|███▋      | 10/27 [00:01<00:02,  8.16it/s]训练:  41%|████      | 11/27 [00:01<00:01,  8.44it/s]训练:  44%|████▍     | 12/27 [00:01<00:01,  8.58it/s]训练:  48%|████▊     | 13/27 [00:01<00:01,  8.73it/s]训练:  52%|█████▏    | 14/27 [00:01<00:01,  8.77it/s]训练:  56%|█████▌    | 15/27 [00:02<00:01,  8.88it/s]训练:  59%|█████▉    | 16/27 [00:02<00:01,  8.92it/s]训练:  63%|██████▎   | 17/27 [00:02<00:01,  9.06it/s]训练:  67%|██████▋   | 18/27 [00:02<00:00,  9.13it/s]训练:  70%|███████   | 19/27 [00:02<00:00,  8.98it/s]训练:  74%|███████▍  | 20/27 [00:02<00:00,  8.96it/s]训练:  78%|███████▊  | 21/27 [00:02<00:00,  8.98it/s]训练:  81%|████████▏ | 22/27 [00:02<00:00,  8.93it/s]训练:  85%|████████▌ | 23/27 [00:02<00:00,  8.96it/s]训练:  89%|████████▉ | 24/27 [00:03<00:00,  8.08it/s]训练:  93%|█████████▎| 25/27 [00:03<00:00,  8.03it/s]训练:  96%|█████████▋| 26/27 [00:03<00:00,  8.43it/s]训练: 100%|██████████| 27/27 [00:03<00:00,  7.87it/s]
Epoch 4/20: Train Loss=1.0316, Val Loss=0.8812, Time=3.8s
  ✓ 保存最佳模型 (val_loss=0.8812)
训练:   0%|          | 0/27 [00:00<?, ?it/s]训练:   4%|▎         | 1/27 [00:00<00:08,  3.05it/s]训练:   7%|▋         | 2/27 [00:00<00:05,  4.79it/s]训练:  11%|█         | 3/27 [00:00<00:04,  5.99it/s]训练:  15%|█▍        | 4/27 [00:00<00:03,  6.74it/s]训练:  19%|█▊        | 5/27 [00:00<00:02,  7.40it/s]训练:  22%|██▏       | 6/27 [00:00<00:02,  7.85it/s]训练:  26%|██▌       | 7/27 [00:01<00:02,  8.07it/s]训练:  30%|██▉       | 8/27 [00:01<00:02,  8.58it/s]训练:  33%|███▎      | 9/27 [00:01<00:02,  8.76it/s]训练:  37%|███▋      | 10/27 [00:01<00:01,  8.86it/s]训练:  41%|████      | 11/27 [00:01<00:01,  8.94it/s]训练:  44%|████▍     | 12/27 [00:01<00:01,  8.90it/s]训练:  48%|████▊     | 13/27 [00:01<00:01,  8.86it/s]训练:  52%|█████▏    | 14/27 [00:01<00:01,  9.14it/s]训练:  59%|█████▉    | 16/27 [00:01<00:01,  9.48it/s]训练:  63%|██████▎   | 17/27 [00:02<00:01,  9.39it/s]训练:  67%|██████▋   | 18/27 [00:02<00:00,  9.35it/s]训练:  70%|███████   | 19/27 [00:02<00:00,  9.34it/s]训练:  74%|███████▍  | 20/27 [00:02<00:00,  9.29it/s]训练:  78%|███████▊  | 21/27 [00:02<00:00,  9.20it/s]训练:  81%|████████▏ | 22/27 [00:02<00:00,  9.30it/s]训练:  85%|████████▌ | 23/27 [00:02<00:00,  9.25it/s]训练:  89%|████████▉ | 24/27 [00:02<00:00,  9.21it/s]训练:  93%|█████████▎| 25/27 [00:02<00:00,  8.60it/s]训练:  96%|█████████▋| 26/27 [00:03<00:00,  8.62it/s]训练: 100%|██████████| 27/27 [00:03<00:00,  8.33it/s]
Epoch 5/20: Train Loss=0.9521, Val Loss=0.9122, Time=3.6s
训练:   0%|          | 0/27 [00:00<?, ?it/s]训练:   4%|▎         | 1/27 [00:00<00:06,  4.05it/s]训练:   7%|▋         | 2/27 [00:00<00:04,  5.73it/s]训练:  11%|█         | 3/27 [00:00<00:03,  6.96it/s]训练:  15%|█▍        | 4/27 [00:00<00:02,  7.74it/s]训练:  19%|█▊        | 5/27 [00:00<00:02,  8.24it/s]训练:  22%|██▏       | 6/27 [00:00<00:02,  8.54it/s]训练:  26%|██▌       | 7/27 [00:00<00:02,  8.77it/s]训练:  30%|██▉       | 8/27 [00:01<00:02,  8.91it/s]训练:  33%|███▎      | 9/27 [00:01<00:01,  9.15it/s]训练:  37%|███▋      | 10/27 [00:01<00:01,  9.23it/s]训练:  41%|████      | 11/27 [00:01<00:01,  9.27it/s]训练:  44%|████▍     | 12/27 [00:01<00:01,  9.31it/s]训练:  48%|████▊     | 13/27 [00:01<00:01,  9.37it/s]训练:  52%|█████▏    | 14/27 [00:01<00:01,  9.22it/s]训练:  56%|█████▌    | 15/27 [00:01<00:01,  9.12it/s]训练:  59%|█████▉    | 16/27 [00:01<00:01,  8.93it/s]训练:  63%|██████▎   | 17/27 [00:02<00:01,  8.10it/s]训练:  67%|██████▋   | 18/27 [00:02<00:01,  8.19it/s]训练:  70%|███████   | 19/27 [00:02<00:00,  8.30it/s]训练:  74%|███████▍  | 20/27 [00:02<00:00,  8.34it/s]训练:  78%|███████▊  | 21/27 [00:02<00:00,  8.49it/s]训练:  81%|████████▏ | 22/27 [00:02<00:00,  8.60it/s]训练:  85%|████████▌ | 23/27 [00:02<00:00,  8.68it/s]训练:  89%|████████▉ | 24/27 [00:02<00:00,  8.77it/s]训练:  93%|█████████▎| 25/27 [00:02<00:00,  8.94it/s]训练:  96%|█████████▋| 26/27 [00:03<00:00,  9.02it/s]训练: 100%|██████████| 27/27 [00:03<00:00,  8.48it/s]
Epoch 6/20: Train Loss=1.0667, Val Loss=0.9196, Time=3.5s
训练:   0%|          | 0/27 [00:00<?, ?it/s]训练:   4%|▎         | 1/27 [00:00<00:07,  3.57it/s]训练:   7%|▋         | 2/27 [00:00<00:04,  5.40it/s]训练:  11%|█         | 3/27 [00:00<00:03,  6.43it/s]训练:  15%|█▍        | 4/27 [00:00<00:03,  7.39it/s]训练:  19%|█▊        | 5/27 [00:00<00:02,  7.74it/s]训练:  22%|██▏       | 6/27 [00:00<00:02,  8.19it/s]训练:  26%|██▌       | 7/27 [00:00<00:02,  8.60it/s]训练:  30%|██▉       | 8/27 [00:01<00:02,  8.80it/s]训练:  33%|███▎      | 9/27 [00:01<00:02,  8.83it/s]训练:  37%|███▋      | 10/27 [00:01<00:01,  8.94it/s]训练:  41%|████      | 11/27 [00:01<00:01,  8.83it/s]训练:  44%|████▍     | 12/27 [00:01<00:01,  8.88it/s]训练:  48%|████▊     | 13/27 [00:01<00:01,  8.64it/s]训练:  52%|█████▏    | 14/27 [00:01<00:01,  8.57it/s]训练:  56%|█████▌    | 15/27 [00:01<00:01,  7.66it/s]训练:  59%|█████▉    | 16/27 [00:02<00:01,  7.48it/s]训练:  63%|██████▎   | 17/27 [00:02<00:01,  7.55it/s]训练:  67%|██████▋   | 18/27 [00:02<00:01,  7.66it/s]训练:  70%|███████   | 19/27 [00:02<00:01,  7.81it/s]训练:  74%|███████▍  | 20/27 [00:02<00:00,  8.03it/s]训练:  78%|███████▊  | 21/27 [00:02<00:00,  8.13it/s]训练:  81%|████████▏ | 22/27 [00:02<00:00,  8.47it/s]训练:  85%|████████▌ | 23/27 [00:02<00:00,  8.65it/s]训练:  89%|████████▉ | 24/27 [00:02<00:00,  8.85it/s]训练:  93%|█████████▎| 25/27 [00:03<00:00,  9.02it/s]训练:  96%|█████████▋| 26/27 [00:03<00:00,  9.21it/s]训练: 100%|██████████| 27/27 [00:03<00:00,  8.17it/s]
Epoch 7/20: Train Loss=0.9068, Val Loss=1.0153, Time=3.7s
训练:   0%|          | 0/27 [00:00<?, ?it/s]训练:   4%|▎         | 1/27 [00:00<00:06,  4.09it/s]训练:   7%|▋         | 2/27 [00:00<00:04,  5.73it/s]训练:  11%|█         | 3/27 [00:00<00:03,  6.90it/s]训练:  15%|█▍        | 4/27 [00:00<00:03,  7.63it/s]训练:  19%|█▊        | 5/27 [00:00<00:02,  8.29it/s]训练:  22%|██▏       | 6/27 [00:00<00:02,  8.51it/s]训练:  26%|██▌       | 7/27 [00:00<00:02,  8.87it/s]训练:  30%|██▉       | 8/27 [00:01<00:02,  8.99it/s]训练:  33%|███▎      | 9/27 [00:01<00:01,  9.04it/s]训练:  37%|███▋      | 10/27 [00:01<00:01,  9.10it/s]训练:  41%|████      | 11/27 [00:01<00:01,  9.33it/s]训练:  44%|████▍     | 12/27 [00:01<00:01,  9.27it/s]训练:  48%|████▊     | 13/27 [00:01<00:01,  9.23it/s]训练:  52%|█████▏    | 14/27 [00:01<00:01,  9.29it/s]训练:  56%|█████▌    | 15/27 [00:01<00:01,  9.22it/s]训练:  59%|█████▉    | 16/27 [00:01<00:01,  9.24it/s]训练:  63%|██████▎   | 17/27 [00:01<00:01,  9.14it/s]训练:  67%|██████▋   | 18/27 [00:02<00:00,  9.27it/s]训练:  70%|███████   | 19/27 [00:02<00:00,  9.24it/s]训练:  74%|███████▍  | 20/27 [00:02<00:00,  9.35it/s]训练:  78%|███████▊  | 21/27 [00:02<00:00,  9.37it/s]训练:  81%|████████▏ | 22/27 [00:02<00:00,  8.64it/s]训练:  85%|████████▌ | 23/27 [00:02<00:00,  8.28it/s]训练:  89%|████████▉ | 24/27 [00:02<00:00,  8.08it/s]训练:  93%|█████████▎| 25/27 [00:02<00:00,  8.01it/s]训练:  96%|█████████▋| 26/27 [00:03<00:00,  7.97it/s]训练: 100%|██████████| 27/27 [00:03<00:00,  8.44it/s]
Epoch 8/20: Train Loss=1.0408, Val Loss=0.8237, Time=3.5s
  ✓ 保存最佳模型 (val_loss=0.8237)
训练:   0%|          | 0/27 [00:00<?, ?it/s]训练:   4%|▎         | 1/27 [00:00<00:09,  2.86it/s]训练:   7%|▋         | 2/27 [00:00<00:05,  4.38it/s]训练:  11%|█         | 3/27 [00:00<00:04,  5.34it/s]训练:  15%|█▍        | 4/27 [00:00<00:03,  6.11it/s]训练:  19%|█▊        | 5/27 [00:00<00:03,  6.92it/s]训练:  22%|██▏       | 6/27 [00:00<00:02,  7.39it/s]训练:  26%|██▌       | 7/27 [00:01<00:02,  7.90it/s]训练:  30%|██▉       | 8/27 [00:01<00:02,  8.24it/s]训练:  37%|███▋      | 10/27 [00:01<00:01,  8.92it/s]训练:  41%|████      | 11/27 [00:01<00:01,  9.04it/s]训练:  44%|████▍     | 12/27 [00:01<00:01,  8.99it/s]训练:  48%|████▊     | 13/27 [00:01<00:01,  9.10it/s]训练:  52%|█████▏    | 14/27 [00:01<00:01,  8.76it/s]训练:  56%|█████▌    | 15/27 [00:01<00:01,  8.85it/s]训练:  59%|█████▉    | 16/27 [00:02<00:01,  8.98it/s]训练:  63%|██████▎   | 17/27 [00:02<00:01,  9.05it/s]训练:  67%|██████▋   | 18/27 [00:02<00:00,  9.02it/s]训练:  70%|███████   | 19/27 [00:02<00:00,  8.75it/s]训练:  74%|███████▍  | 20/27 [00:02<00:00,  8.76it/s]训练:  78%|███████▊  | 21/27 [00:02<00:00,  8.14it/s]训练:  81%|████████▏ | 22/27 [00:02<00:00,  8.07it/s]训练:  85%|████████▌ | 23/27 [00:02<00:00,  7.98it/s]训练:  89%|████████▉ | 24/27 [00:03<00:00,  7.91it/s]训练:  93%|█████████▎| 25/27 [00:03<00:00,  7.97it/s]训练:  96%|█████████▋| 26/27 [00:03<00:00,  7.95it/s]训练: 100%|██████████| 27/27 [00:03<00:00,  7.84it/s]
Epoch 9/20: Train Loss=0.9154, Val Loss=1.0662, Time=3.9s
训练:   0%|          | 0/27 [00:00<?, ?it/s]训练:   4%|▎         | 1/27 [00:00<00:06,  3.88it/s]训练:   7%|▋         | 2/27 [00:00<00:04,  5.58it/s]训练:  11%|█         | 3/27 [00:00<00:03,  6.43it/s]训练:  15%|█▍        | 4/27 [00:00<00:03,  6.92it/s]训练:  19%|█▊        | 5/27 [00:00<00:03,  6.96it/s]训练:  22%|██▏       | 6/27 [00:00<00:02,  7.20it/s]训练:  26%|██▌       | 7/27 [00:01<00:02,  7.54it/s]训练:  30%|██▉       | 8/27 [00:01<00:02,  7.83it/s]训练:  33%|███▎      | 9/27 [00:01<00:02,  8.06it/s]训练:  37%|███▋      | 10/27 [00:01<00:02,  8.29it/s]训练:  41%|████      | 11/27 [00:01<00:01,  8.38it/s]训练:  44%|████▍     | 12/27 [00:01<00:01,  8.70it/s]训练:  48%|████▊     | 13/27 [00:01<00:01,  8.08it/s]训练:  52%|█████▏    | 14/27 [00:01<00:01,  8.13it/s]训练:  56%|█████▌    | 15/27 [00:01<00:01,  8.29it/s]训练:  59%|█████▉    | 16/27 [00:02<00:01,  8.27it/s]训练:  63%|██████▎   | 17/27 [00:02<00:01,  8.56it/s]训练:  67%|██████▋   | 18/27 [00:02<00:01,  8.67it/s]训练:  70%|███████   | 19/27 [00:02<00:00,  8.91it/s]训练:  78%|███████▊  | 21/27 [00:02<00:00,  9.31it/s]训练:  81%|████████▏ | 22/27 [00:02<00:00,  9.38it/s]训练:  85%|████████▌ | 23/27 [00:02<00:00,  8.66it/s]训练:  89%|████████▉ | 24/27 [00:02<00:00,  8.73it/s]训练:  93%|█████████▎| 25/27 [00:03<00:00,  8.56it/s]训练: 100%|██████████| 27/27 [00:03<00:00,  9.71it/s]训练: 100%|██████████| 27/27 [00:03<00:00,  8.12it/s]
Epoch 10/20: Train Loss=0.9851, Val Loss=0.9330, Time=3.7s
训练:   0%|          | 0/27 [00:00<?, ?it/s]训练:   4%|▎         | 1/27 [00:00<00:06,  3.83it/s]训练:   7%|▋         | 2/27 [00:00<00:04,  5.74it/s]训练:  11%|█         | 3/27 [00:00<00:03,  6.83it/s]训练:  15%|█▍        | 4/27 [00:00<00:03,  7.61it/s]训练:  19%|█▊        | 5/27 [00:00<00:02,  7.57it/s]训练:  22%|██▏       | 6/27 [00:00<00:02,  7.83it/s]训练:  26%|██▌       | 7/27 [00:00<00:02,  8.16it/s]训练:  30%|██▉       | 8/27 [00:01<00:02,  8.43it/s]训练:  33%|███▎      | 9/27 [00:01<00:02,  8.73it/s]训练:  37%|███▋      | 10/27 [00:01<00:01,  8.94it/s]训练:  41%|████      | 11/27 [00:01<00:01,  8.96it/s]训练:  44%|████▍     | 12/27 [00:01<00:01,  8.92it/s]训练:  48%|████▊     | 13/27 [00:01<00:01,  9.14it/s]训练:  52%|█████▏    | 14/27 [00:01<00:01,  9.09it/s]训练:  56%|█████▌    | 15/27 [00:01<00:01,  9.07it/s]训练:  59%|█████▉    | 16/27 [00:01<00:01,  9.26it/s]训练:  63%|██████▎   | 17/27 [00:02<00:01,  9.38it/s]训练:  67%|██████▋   | 18/27 [00:02<00:00,  9.18it/s]训练:  70%|███████   | 19/27 [00:02<00:00,  9.20it/s]训练:  78%|███████▊  | 21/27 [00:02<00:00,  9.46it/s]训练:  81%|████████▏ | 22/27 [00:02<00:00,  9.55it/s]训练:  85%|████████▌ | 23/27 [00:02<00:00,  9.44it/s]训练:  89%|████████▉ | 24/27 [00:02<00:00,  9.49it/s]训练:  96%|█████████▋| 26/27 [00:02<00:00,  9.48it/s]训练: 100%|██████████| 27/27 [00:03<00:00,  8.66it/s]
Epoch 11/20: Train Loss=1.1164, Val Loss=0.8796, Time=3.6s
训练:   0%|          | 0/27 [00:00<?, ?it/s]训练:   4%|▎         | 1/27 [00:00<00:09,  2.74it/s]训练:   7%|▋         | 2/27 [00:00<00:05,  4.40it/s]训练:  11%|█         | 3/27 [00:00<00:04,  5.64it/s]训练:  15%|█▍        | 4/27 [00:00<00:03,  6.61it/s]训练:  19%|█▊        | 5/27 [00:00<00:03,  7.26it/s]训练:  22%|██▏       | 6/27 [00:00<00:02,  7.82it/s]训练:  26%|██▌       | 7/27 [00:01<00:02,  8.38it/s]训练:  30%|██▉       | 8/27 [00:01<00:02,  8.74it/s]训练:  33%|███▎      | 9/27 [00:01<00:02,  8.82it/s]训练:  37%|███▋      | 10/27 [00:01<00:01,  8.94it/s]训练:  41%|████      | 11/27 [00:01<00:01,  9.03it/s]训练:  44%|████▍     | 12/27 [00:01<00:01,  9.16it/s]训练:  48%|████▊     | 13/27 [00:01<00:01,  9.08it/s]训练:  52%|█████▏    | 14/27 [00:01<00:01,  9.12it/s]训练:  56%|█████▌    | 15/27 [00:01<00:01,  9.28it/s]训练:  59%|█████▉    | 16/27 [00:02<00:01,  9.11it/s]训练:  67%|██████▋   | 18/27 [00:02<00:00,  9.22it/s]训练:  70%|███████   | 19/27 [00:02<00:00,  9.09it/s]训练:  74%|███████▍  | 20/27 [00:02<00:00,  8.97it/s]训练:  78%|███████▊  | 21/27 [00:02<00:00,  8.92it/s]训练:  81%|████████▏ | 22/27 [00:02<00:00,  9.15it/s]训练:  85%|████████▌ | 23/27 [00:02<00:00,  9.03it/s]训练:  89%|████████▉ | 24/27 [00:02<00:00,  8.98it/s]训练:  93%|█████████▎| 25/27 [00:03<00:00,  9.10it/s]训练:  96%|█████████▋| 26/27 [00:03<00:00,  9.17it/s]训练: 100%|██████████| 27/27 [00:03<00:00,  8.31it/s]
Epoch 12/20: Train Loss=1.0194, Val Loss=1.0081, Time=3.6s
训练:   0%|          | 0/27 [00:00<?, ?it/s]训练:   4%|▎         | 1/27 [00:00<00:07,  3.56it/s]训练:   7%|▋         | 2/27 [00:00<00:05,  4.90it/s]训练:  11%|█         | 3/27 [00:00<00:04,  5.86it/s]训练:  15%|█▍        | 4/27 [00:00<00:03,  6.77it/s]训练:  22%|██▏       | 6/27 [00:00<00:02,  7.95it/s]训练:  26%|██▌       | 7/27 [00:01<00:02,  8.15it/s]训练:  30%|██▉       | 8/27 [00:01<00:02,  8.23it/s]训练:  33%|███▎      | 9/27 [00:01<00:02,  8.33it/s]训练:  37%|███▋      | 10/27 [00:01<00:01,  8.68it/s]训练:  41%|████      | 11/27 [00:01<00:01,  8.75it/s]训练:  44%|████▍     | 12/27 [00:01<00:01,  8.70it/s]训练:  48%|████▊     | 13/27 [00:01<00:01,  8.80it/s]训练:  56%|█████▌    | 15/27 [00:01<00:01,  9.18it/s]训练:  59%|█████▉    | 16/27 [00:01<00:01,  9.10it/s]训练:  63%|██████▎   | 17/27 [00:02<00:01,  9.08it/s]训练:  67%|██████▋   | 18/27 [00:02<00:00,  9.02it/s]训练:  70%|███████   | 19/27 [00:02<00:00,  8.86it/s]训练:  74%|███████▍  | 20/27 [00:02<00:00,  8.91it/s]训练:  78%|███████▊  | 21/27 [00:02<00:00,  8.97it/s]训练:  81%|████████▏ | 22/27 [00:02<00:00,  8.89it/s]训练:  85%|████████▌ | 23/27 [00:02<00:00,  8.99it/s]训练:  89%|████████▉ | 24/27 [00:02<00:00,  8.99it/s]训练:  93%|█████████▎| 25/27 [00:03<00:00,  9.10it/s]训练:  96%|█████████▋| 26/27 [00:03<00:00,  8.96it/s]训练: 100%|██████████| 27/27 [00:03<00:00,  8.36it/s]
Epoch 13/20: Train Loss=1.0532, Val Loss=1.0162, Time=3.6s

早停: 5 epochs无改进
------------------------------------------------------------

最终测试...
测试集损失: 0.8821

✓ 训练完成!
  最佳验证损失: 0.8237
  测试损失: 0.8821
  模型已保存到: test_results/best_model_large.pt
