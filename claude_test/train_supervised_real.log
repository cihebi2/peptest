/home/qlyu/AA_peptide/pepland/claude_test/train_real_supervised.py:149: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
============================================================
监督学习训练 - 真实数据
============================================================

设备: cuda:0 (物理GPU 2)

配置:
  data_dir: /home/qlyu/AA_peptide/pepland/data/pretrained
  batch_size: 32
  hidden_dim: 256
  num_layers: 6
  num_heads: 8
  dropout: 0.1
  learning_rate: 0.0001
  weight_decay: 1e-05
  num_epochs: 10
  max_samples: None

加载数据...
加载数据: /home/qlyu/AA_peptide/pepland/data/pretrained/train.csv
  总样本数: 998
  有效样本数: 998
加载数据: /home/qlyu/AA_peptide/pepland/data/pretrained/valid.csv
  总样本数: 998
  有效样本数: 998
加载数据: /home/qlyu/AA_peptide/pepland/data/pretrained/test.csv
  总样本数: 998
  有效样本数: 998

创建模型...
  模型参数量: 6,651,663

开始训练...
------------------------------------------------------------
训练:   0%|          | 0/32 [00:00<?, ?it/s]/home/qlyu/AA_peptide/pepland/claude_test/train_real_supervised.py:37: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home/qlyu/anaconda3/envs/cuda12.1/lib/python3.11/site-packages/dgl/backend/pytorch/sparse.py:157: FutureWarning: `torch.cuda.amp.autocast_mode._cast(value, dtype)` is deprecated. Please use `torch.amp.autocast_mode._cast(value, 'cuda', dtype)` instead.
  return th.cuda.amp.autocast_mode._cast(
/home/qlyu/anaconda3/envs/cuda12.1/lib/python3.11/site-packages/dgl/backend/pytorch/sparse.py:148: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  return th.cuda.amp.autocast(enabled=False)
训练:   3%|▎         | 1/32 [00:01<00:32,  1.04s/it]训练:   6%|▋         | 2/32 [00:01<00:14,  2.01it/s]训练:   9%|▉         | 3/32 [00:01<00:09,  3.11it/s]训练:  12%|█▎        | 4/32 [00:01<00:06,  4.19it/s]训练:  16%|█▌        | 5/32 [00:01<00:05,  5.12it/s]训练:  19%|█▉        | 6/32 [00:01<00:04,  5.95it/s]训练:  22%|██▏       | 7/32 [00:01<00:03,  6.65it/s]训练:  25%|██▌       | 8/32 [00:01<00:03,  7.27it/s]训练:  28%|██▊       | 9/32 [00:01<00:02,  7.84it/s]训练:  31%|███▏      | 10/32 [00:02<00:02,  7.99it/s]训练:  34%|███▍      | 11/32 [00:02<00:02,  7.44it/s]训练:  38%|███▊      | 12/32 [00:02<00:02,  7.52it/s]训练:  41%|████      | 13/32 [00:02<00:02,  7.70it/s]训练:  44%|████▍     | 14/32 [00:02<00:02,  7.93it/s]训练:  47%|████▋     | 15/32 [00:02<00:02,  8.36it/s]训练:  50%|█████     | 16/32 [00:02<00:01,  8.50it/s]训练:  53%|█████▎    | 17/32 [00:02<00:01,  8.70it/s]训练:  56%|█████▋    | 18/32 [00:03<00:01,  8.59it/s]训练:  59%|█████▉    | 19/32 [00:03<00:01,  8.83it/s]训练:  62%|██████▎   | 20/32 [00:03<00:01,  8.75it/s]训练:  66%|██████▌   | 21/32 [00:03<00:01,  8.63it/s]训练:  69%|██████▉   | 22/32 [00:03<00:01,  8.63it/s]训练:  72%|███████▏  | 23/32 [00:03<00:01,  8.84it/s]训练:  75%|███████▌  | 24/32 [00:03<00:00,  9.01it/s]训练:  78%|███████▊  | 25/32 [00:03<00:00,  9.15it/s]训练:  81%|████████▏ | 26/32 [00:03<00:00,  9.16it/s]训练:  84%|████████▍ | 27/32 [00:04<00:00,  9.28it/s]训练:  88%|████████▊ | 28/32 [00:04<00:00,  9.30it/s]训练:  91%|█████████ | 29/32 [00:04<00:00,  9.25it/s]训练:  94%|█████████▍| 30/32 [00:04<00:00,  9.37it/s]训练:  97%|█████████▋| 31/32 [00:04<00:00,  9.26it/s]训练: 100%|██████████| 32/32 [00:04<00:00,  7.04it/s]
Epoch 1/10: Train Loss=1.0817, Val Loss=1.0695, Time=6.4s
  ✓ 保存最佳模型 (val_loss=1.0695)
训练:   0%|          | 0/32 [00:00<?, ?it/s]训练:   3%|▎         | 1/32 [00:00<00:09,  3.22it/s]训练:   6%|▋         | 2/32 [00:00<00:06,  4.53it/s]训练:   9%|▉         | 3/32 [00:00<00:05,  5.60it/s]训练:  12%|█▎        | 4/32 [00:00<00:04,  6.41it/s]训练:  16%|█▌        | 5/32 [00:00<00:03,  6.97it/s]训练:  19%|█▉        | 6/32 [00:00<00:03,  7.43it/s]训练:  22%|██▏       | 7/32 [00:01<00:03,  7.71it/s]训练:  25%|██▌       | 8/32 [00:01<00:03,  7.46it/s]训练:  28%|██▊       | 9/32 [00:01<00:03,  7.56it/s]训练:  31%|███▏      | 10/32 [00:01<00:02,  7.91it/s]训练:  34%|███▍      | 11/32 [00:01<00:02,  8.24it/s]训练:  38%|███▊      | 12/32 [00:01<00:02,  8.43it/s]训练:  41%|████      | 13/32 [00:01<00:02,  8.64it/s]训练:  44%|████▍     | 14/32 [00:01<00:02,  8.90it/s]训练:  47%|████▋     | 15/32 [00:02<00:01,  8.96it/s]训练:  50%|█████     | 16/32 [00:02<00:01,  8.77it/s]训练:  53%|█████▎    | 17/32 [00:02<00:01,  8.58it/s]训练:  56%|█████▋    | 18/32 [00:02<00:01,  8.86it/s]训练:  59%|█████▉    | 19/32 [00:02<00:01,  8.92it/s]训练:  62%|██████▎   | 20/32 [00:02<00:01,  8.95it/s]训练:  66%|██████▌   | 21/32 [00:02<00:01,  9.16it/s]训练:  69%|██████▉   | 22/32 [00:02<00:01,  9.07it/s]训练:  72%|███████▏  | 23/32 [00:02<00:00,  9.03it/s]训练:  75%|███████▌  | 24/32 [00:03<00:00,  9.20it/s]训练:  78%|███████▊  | 25/32 [00:03<00:00,  9.22it/s]训练:  81%|████████▏ | 26/32 [00:03<00:00,  9.31it/s]训练:  88%|████████▊ | 28/32 [00:03<00:00,  9.48it/s]训练:  91%|█████████ | 29/32 [00:03<00:00,  9.49it/s]训练:  94%|█████████▍| 30/32 [00:03<00:00,  9.48it/s]训练:  97%|█████████▋| 31/32 [00:03<00:00,  9.45it/s]训练: 100%|██████████| 32/32 [00:03<00:00,  8.28it/s]
Epoch 2/10: Train Loss=1.0025, Val Loss=0.9804, Time=5.6s
  ✓ 保存最佳模型 (val_loss=0.9804)
训练:   0%|          | 0/32 [00:00<?, ?it/s]训练:   3%|▎         | 1/32 [00:00<00:08,  3.58it/s]训练:   6%|▋         | 2/32 [00:00<00:05,  5.44it/s]训练:   9%|▉         | 3/32 [00:00<00:04,  6.56it/s]训练:  12%|█▎        | 4/32 [00:00<00:03,  7.30it/s]训练:  16%|█▌        | 5/32 [00:00<00:03,  7.67it/s]训练:  19%|█▉        | 6/32 [00:00<00:03,  8.05it/s]训练:  22%|██▏       | 7/32 [00:00<00:03,  8.32it/s]训练:  25%|██▌       | 8/32 [00:01<00:02,  8.53it/s]训练:  28%|██▊       | 9/32 [00:01<00:02,  8.73it/s]训练:  31%|███▏      | 10/32 [00:01<00:02,  8.88it/s]训练:  34%|███▍      | 11/32 [00:01<00:02,  8.84it/s]训练:  38%|███▊      | 12/32 [00:01<00:02,  8.77it/s]训练:  41%|████      | 13/32 [00:01<00:02,  8.86it/s]训练:  44%|████▍     | 14/32 [00:01<00:02,  8.71it/s]训练:  47%|████▋     | 15/32 [00:01<00:01,  8.68it/s]训练:  50%|█████     | 16/32 [00:01<00:01,  8.75it/s]训练:  53%|█████▎    | 17/32 [00:02<00:01,  8.86it/s]训练:  56%|█████▋    | 18/32 [00:02<00:01,  9.03it/s]训练:  59%|█████▉    | 19/32 [00:02<00:01,  9.08it/s]训练:  66%|██████▌   | 21/32 [00:02<00:01,  9.38it/s]训练:  69%|██████▉   | 22/32 [00:02<00:01,  9.30it/s]训练:  72%|███████▏  | 23/32 [00:02<00:00,  9.28it/s]训练:  75%|███████▌  | 24/32 [00:02<00:00,  9.22it/s]训练:  78%|███████▊  | 25/32 [00:02<00:00,  9.17it/s]训练:  81%|████████▏ | 26/32 [00:03<00:00,  9.26it/s]训练:  84%|████████▍ | 27/32 [00:03<00:00,  9.21it/s]训练:  88%|████████▊ | 28/32 [00:03<00:00,  8.96it/s]训练:  91%|█████████ | 29/32 [00:03<00:00,  8.78it/s]训练:  94%|█████████▍| 30/32 [00:03<00:00,  8.96it/s]训练:  97%|█████████▋| 31/32 [00:03<00:00,  8.97it/s]训练: 100%|██████████| 32/32 [00:03<00:00,  8.59it/s]
Epoch 3/10: Train Loss=0.9700, Val Loss=1.0199, Time=5.6s
训练:   0%|          | 0/32 [00:00<?, ?it/s]训练:   3%|▎         | 1/32 [00:00<00:10,  2.92it/s]训练:   6%|▋         | 2/32 [00:00<00:06,  4.49it/s]训练:   9%|▉         | 3/32 [00:00<00:05,  5.17it/s]训练:  12%|█▎        | 4/32 [00:00<00:04,  5.93it/s]训练:  16%|█▌        | 5/32 [00:00<00:04,  6.74it/s]训练:  19%|█▉        | 6/32 [00:00<00:03,  7.40it/s]训练:  22%|██▏       | 7/32 [00:01<00:03,  7.69it/s]训练:  25%|██▌       | 8/32 [00:01<00:02,  8.06it/s]训练:  28%|██▊       | 9/32 [00:01<00:02,  8.39it/s]训练:  31%|███▏      | 10/32 [00:01<00:02,  8.44it/s]训练:  34%|███▍      | 11/32 [00:01<00:02,  8.73it/s]训练:  38%|███▊      | 12/32 [00:01<00:02,  8.98it/s]训练:  41%|████      | 13/32 [00:01<00:02,  8.94it/s]训练:  44%|████▍     | 14/32 [00:01<00:02,  8.98it/s]训练:  47%|████▋     | 15/32 [00:02<00:01,  8.56it/s]训练:  50%|█████     | 16/32 [00:02<00:01,  8.54it/s]训练:  53%|█████▎    | 17/32 [00:02<00:01,  8.58it/s]训练:  56%|█████▋    | 18/32 [00:02<00:01,  8.64it/s]训练:  59%|█████▉    | 19/32 [00:02<00:01,  8.77it/s]训练:  62%|██████▎   | 20/32 [00:02<00:01,  8.84it/s]训练:  66%|██████▌   | 21/32 [00:02<00:01,  8.83it/s]训练:  69%|██████▉   | 22/32 [00:02<00:01,  8.72it/s]训练:  72%|███████▏  | 23/32 [00:02<00:01,  7.51it/s]训练:  75%|███████▌  | 24/32 [00:03<00:01,  7.49it/s]训练:  78%|███████▊  | 25/32 [00:03<00:00,  7.69it/s]训练:  81%|████████▏ | 26/32 [00:03<00:00,  8.06it/s]训练:  84%|████████▍ | 27/32 [00:03<00:00,  8.34it/s]训练:  88%|████████▊ | 28/32 [00:03<00:00,  8.48it/s]训练:  91%|█████████ | 29/32 [00:03<00:00,  8.40it/s]训练:  94%|█████████▍| 30/32 [00:03<00:00,  8.71it/s]训练:  97%|█████████▋| 31/32 [00:03<00:00,  8.86it/s]训练: 100%|██████████| 32/32 [00:04<00:00,  7.97it/s]
Epoch 4/10: Train Loss=0.9841, Val Loss=0.9909, Time=5.7s
训练:   0%|          | 0/32 [00:00<?, ?it/s]训练:   3%|▎         | 1/32 [00:00<00:08,  3.79it/s]训练:   6%|▋         | 2/32 [00:00<00:05,  5.08it/s]训练:   9%|▉         | 3/32 [00:00<00:04,  6.02it/s]训练:  12%|█▎        | 4/32 [00:00<00:04,  6.72it/s]训练:  16%|█▌        | 5/32 [00:00<00:03,  7.48it/s]训练:  19%|█▉        | 6/32 [00:00<00:03,  7.72it/s]训练:  22%|██▏       | 7/32 [00:01<00:03,  7.34it/s]训练:  25%|██▌       | 8/32 [00:01<00:03,  7.42it/s]训练:  28%|██▊       | 9/32 [00:01<00:03,  7.58it/s]训练:  31%|███▏      | 10/32 [00:01<00:02,  7.79it/s]训练:  34%|███▍      | 11/32 [00:01<00:02,  8.08it/s]训练:  38%|███▊      | 12/32 [00:01<00:02,  8.31it/s]训练:  41%|████      | 13/32 [00:01<00:02,  8.43it/s]训练:  44%|████▍     | 14/32 [00:01<00:02,  8.54it/s]训练:  47%|████▋     | 15/32 [00:01<00:01,  8.62it/s]训练:  50%|█████     | 16/32 [00:02<00:01,  8.65it/s]训练:  53%|█████▎    | 17/32 [00:02<00:01,  8.72it/s]训练:  59%|█████▉    | 19/32 [00:02<00:01,  9.14it/s]训练:  62%|██████▎   | 20/32 [00:02<00:01,  9.11it/s]训练:  66%|██████▌   | 21/32 [00:02<00:01,  9.09it/s]训练:  69%|██████▉   | 22/32 [00:02<00:01,  9.08it/s]训练:  72%|███████▏  | 23/32 [00:02<00:00,  9.12it/s]训练:  75%|███████▌  | 24/32 [00:02<00:00,  9.23it/s]训练:  78%|███████▊  | 25/32 [00:03<00:00,  9.17it/s]训练:  81%|████████▏ | 26/32 [00:03<00:00,  9.12it/s]训练:  84%|████████▍ | 27/32 [00:03<00:00,  9.18it/s]训练:  88%|████████▊ | 28/32 [00:03<00:00,  8.94it/s]训练:  91%|█████████ | 29/32 [00:03<00:00,  8.53it/s]训练:  94%|█████████▍| 30/32 [00:03<00:00,  8.29it/s]训练:  97%|█████████▋| 31/32 [00:03<00:00,  8.19it/s]训练: 100%|██████████| 32/32 [00:03<00:00,  8.17it/s]
Epoch 5/10: Train Loss=1.0426, Val Loss=0.9504, Time=5.8s
  ✓ 保存最佳模型 (val_loss=0.9504)
训练:   0%|          | 0/32 [00:00<?, ?it/s]训练:   3%|▎         | 1/32 [00:00<00:09,  3.32it/s]训练:   6%|▋         | 2/32 [00:00<00:05,  5.12it/s]训练:   9%|▉         | 3/32 [00:00<00:04,  6.34it/s]训练:  12%|█▎        | 4/32 [00:00<00:04,  6.38it/s]训练:  16%|█▌        | 5/32 [00:00<00:03,  6.91it/s]训练:  19%|█▉        | 6/32 [00:00<00:03,  7.48it/s]训练:  22%|██▏       | 7/32 [00:01<00:03,  7.80it/s]训练:  25%|██▌       | 8/32 [00:01<00:03,  7.92it/s]训练:  28%|██▊       | 9/32 [00:01<00:02,  8.13it/s]训练:  31%|███▏      | 10/32 [00:01<00:02,  8.11it/s]训练:  34%|███▍      | 11/32 [00:01<00:02,  7.89it/s]训练:  38%|███▊      | 12/32 [00:01<00:02,  7.77it/s]训练:  41%|████      | 13/32 [00:01<00:02,  7.85it/s]训练:  44%|████▍     | 14/32 [00:01<00:02,  8.03it/s]训练:  47%|████▋     | 15/32 [00:02<00:02,  8.22it/s]训练:  50%|█████     | 16/32 [00:02<00:01,  8.47it/s]训练:  53%|█████▎    | 17/32 [00:02<00:01,  8.64it/s]训练:  56%|█████▋    | 18/32 [00:02<00:01,  8.76it/s]训练:  59%|█████▉    | 19/32 [00:02<00:01,  8.88it/s]训练:  62%|██████▎   | 20/32 [00:02<00:01,  8.93it/s]训练:  66%|██████▌   | 21/32 [00:02<00:01,  8.20it/s]训练:  69%|██████▉   | 22/32 [00:02<00:01,  8.23it/s]训练:  72%|███████▏  | 23/32 [00:02<00:01,  8.37it/s]训练:  75%|███████▌  | 24/32 [00:03<00:00,  8.43it/s]训练:  78%|███████▊  | 25/32 [00:03<00:00,  8.69it/s]训练:  81%|████████▏ | 26/32 [00:03<00:00,  8.73it/s]训练:  84%|████████▍ | 27/32 [00:03<00:00,  8.93it/s]训练:  88%|████████▊ | 28/32 [00:03<00:00,  9.03it/s]训练:  91%|█████████ | 29/32 [00:03<00:00,  9.10it/s]训练:  94%|█████████▍| 30/32 [00:03<00:00,  8.57it/s]训练:  97%|█████████▋| 31/32 [00:03<00:00,  8.61it/s]训练: 100%|██████████| 32/32 [00:03<00:00,  8.05it/s]
Epoch 6/10: Train Loss=1.0073, Val Loss=0.9800, Time=5.8s
训练:   0%|          | 0/32 [00:00<?, ?it/s]训练:   3%|▎         | 1/32 [00:00<00:08,  3.46it/s]训练:   6%|▋         | 2/32 [00:00<00:05,  5.32it/s]训练:   9%|▉         | 3/32 [00:00<00:04,  6.28it/s]训练:  12%|█▎        | 4/32 [00:00<00:04,  6.81it/s]训练:  16%|█▌        | 5/32 [00:00<00:03,  7.39it/s]训练:  19%|█▉        | 6/32 [00:00<00:03,  7.80it/s]训练:  22%|██▏       | 7/32 [00:01<00:03,  7.18it/s]训练:  25%|██▌       | 8/32 [00:01<00:03,  6.66it/s]训练:  28%|██▊       | 9/32 [00:01<00:03,  6.68it/s]训练:  31%|███▏      | 10/32 [00:01<00:03,  6.96it/s]训练:  34%|███▍      | 11/32 [00:01<00:02,  7.29it/s]训练:  38%|███▊      | 12/32 [00:01<00:02,  7.65it/s]训练:  41%|████      | 13/32 [00:01<00:02,  8.02it/s]训练:  44%|████▍     | 14/32 [00:01<00:02,  8.42it/s]训练:  47%|████▋     | 15/32 [00:02<00:01,  8.66it/s]训练:  50%|█████     | 16/32 [00:02<00:01,  8.73it/s]训练:  53%|█████▎    | 17/32 [00:02<00:01,  8.84it/s]训练:  56%|█████▋    | 18/32 [00:02<00:01,  8.91it/s]训练:  59%|█████▉    | 19/32 [00:02<00:01,  8.93it/s]训练:  62%|██████▎   | 20/32 [00:02<00:01,  8.94it/s]训练:  66%|██████▌   | 21/32 [00:02<00:01,  8.90it/s]训练:  69%|██████▉   | 22/32 [00:02<00:01,  9.03it/s]训练:  72%|███████▏  | 23/32 [00:02<00:00,  9.23it/s]训练:  75%|███████▌  | 24/32 [00:03<00:00,  9.19it/s]训练:  78%|███████▊  | 25/32 [00:03<00:00,  9.17it/s]训练:  81%|████████▏ | 26/32 [00:03<00:00,  9.01it/s]训练:  84%|████████▍ | 27/32 [00:03<00:00,  9.03it/s]训练:  88%|████████▊ | 28/32 [00:03<00:00,  9.11it/s]训练:  91%|█████████ | 29/32 [00:03<00:00,  9.16it/s]训练:  94%|█████████▍| 30/32 [00:03<00:00,  8.72it/s]训练:  97%|█████████▋| 31/32 [00:03<00:00,  7.89it/s]训练: 100%|██████████| 32/32 [00:04<00:00,  8.00it/s]
Epoch 7/10: Train Loss=1.0796, Val Loss=0.8983, Time=5.9s
  ✓ 保存最佳模型 (val_loss=0.8983)
训练:   0%|          | 0/32 [00:00<?, ?it/s]训练:   3%|▎         | 1/32 [00:00<00:10,  2.93it/s]训练:   6%|▋         | 2/32 [00:00<00:06,  4.62it/s]训练:   9%|▉         | 3/32 [00:00<00:05,  5.71it/s]训练:  12%|█▎        | 4/32 [00:00<00:04,  6.51it/s]训练:  16%|█▌        | 5/32 [00:00<00:03,  7.16it/s]训练:  19%|█▉        | 6/32 [00:00<00:03,  7.72it/s]训练:  22%|██▏       | 7/32 [00:01<00:03,  8.16it/s]训练:  25%|██▌       | 8/32 [00:01<00:02,  8.54it/s]训练:  28%|██▊       | 9/32 [00:01<00:02,  8.58it/s]训练:  31%|███▏      | 10/32 [00:01<00:02,  8.73it/s]训练:  34%|███▍      | 11/32 [00:01<00:02,  8.52it/s]训练:  38%|███▊      | 12/32 [00:01<00:02,  8.30it/s]训练:  41%|████      | 13/32 [00:01<00:02,  8.23it/s]训练:  44%|████▍     | 14/32 [00:01<00:02,  8.04it/s]训练:  47%|████▋     | 15/32 [00:02<00:02,  7.52it/s]训练:  50%|█████     | 16/32 [00:02<00:02,  7.66it/s]训练:  53%|█████▎    | 17/32 [00:02<00:01,  8.05it/s]训练:  56%|█████▋    | 18/32 [00:02<00:01,  8.46it/s]训练:  59%|█████▉    | 19/32 [00:02<00:01,  8.54it/s]训练:  62%|██████▎   | 20/32 [00:02<00:01,  8.49it/s]训练:  66%|██████▌   | 21/32 [00:02<00:01,  8.70it/s]训练:  69%|██████▉   | 22/32 [00:02<00:01,  8.67it/s]训练:  72%|███████▏  | 23/32 [00:02<00:01,  8.85it/s]训练:  75%|███████▌  | 24/32 [00:03<00:00,  8.67it/s]训练:  78%|███████▊  | 25/32 [00:03<00:00,  7.88it/s]训练:  81%|████████▏ | 26/32 [00:03<00:00,  7.83it/s]训练:  84%|████████▍ | 27/32 [00:03<00:00,  7.80it/s]训练:  88%|████████▊ | 28/32 [00:03<00:00,  8.04it/s]训练:  91%|█████████ | 29/32 [00:03<00:00,  8.46it/s]训练:  94%|█████████▍| 30/32 [00:03<00:00,  8.57it/s]训练:  97%|█████████▋| 31/32 [00:03<00:00,  8.63it/s]训练: 100%|██████████| 32/32 [00:04<00:00,  7.98it/s]
Epoch 8/10: Train Loss=1.0362, Val Loss=0.9342, Time=5.8s
训练:   0%|          | 0/32 [00:00<?, ?it/s]训练:   3%|▎         | 1/32 [00:00<00:09,  3.32it/s]训练:   6%|▋         | 2/32 [00:00<00:06,  4.86it/s]训练:   9%|▉         | 3/32 [00:00<00:04,  5.95it/s]训练:  12%|█▎        | 4/32 [00:00<00:04,  6.54it/s]训练:  16%|█▌        | 5/32 [00:00<00:03,  7.35it/s]训练:  19%|█▉        | 6/32 [00:00<00:03,  7.93it/s]训练:  22%|██▏       | 7/32 [00:01<00:03,  8.22it/s]训练:  25%|██▌       | 8/32 [00:01<00:02,  8.50it/s]训练:  28%|██▊       | 9/32 [00:01<00:02,  7.83it/s]训练:  31%|███▏      | 10/32 [00:01<00:02,  7.65it/s]训练:  34%|███▍      | 11/32 [00:01<00:02,  7.61it/s]训练:  38%|███▊      | 12/32 [00:01<00:02,  7.59it/s]训练:  41%|████      | 13/32 [00:01<00:02,  7.83it/s]训练:  44%|████▍     | 14/32 [00:01<00:02,  7.98it/s]训练:  47%|████▋     | 15/32 [00:02<00:02,  8.22it/s]训练:  50%|█████     | 16/32 [00:02<00:01,  8.40it/s]训练:  53%|█████▎    | 17/32 [00:02<00:01,  8.68it/s]训练:  56%|█████▋    | 18/32 [00:02<00:01,  8.71it/s]训练:  59%|█████▉    | 19/32 [00:02<00:01,  8.87it/s]训练:  62%|██████▎   | 20/32 [00:02<00:01,  8.25it/s]训练:  66%|██████▌   | 21/32 [00:02<00:01,  8.03it/s]训练:  69%|██████▉   | 22/32 [00:02<00:01,  7.87it/s]训练:  72%|███████▏  | 23/32 [00:03<00:01,  7.91it/s]训练:  75%|███████▌  | 24/32 [00:03<00:00,  8.10it/s]训练:  78%|███████▊  | 25/32 [00:03<00:00,  8.30it/s]训练:  81%|████████▏ | 26/32 [00:03<00:00,  8.44it/s]训练:  84%|████████▍ | 27/32 [00:03<00:00,  8.44it/s]训练:  88%|████████▊ | 28/32 [00:03<00:00,  8.67it/s]训练:  91%|█████████ | 29/32 [00:03<00:00,  8.75it/s]训练:  94%|█████████▍| 30/32 [00:03<00:00,  8.86it/s]训练:  97%|█████████▋| 31/32 [00:03<00:00,  8.96it/s]训练: 100%|██████████| 32/32 [00:03<00:00,  8.01it/s]
Epoch 9/10: Train Loss=0.9946, Val Loss=1.0703, Time=5.8s
训练:   0%|          | 0/32 [00:00<?, ?it/s]训练:   3%|▎         | 1/32 [00:00<00:08,  3.49it/s]训练:   6%|▋         | 2/32 [00:00<00:05,  5.35it/s]训练:   9%|▉         | 3/32 [00:00<00:04,  6.47it/s]训练:  12%|█▎        | 4/32 [00:00<00:03,  7.42it/s]训练:  16%|█▌        | 5/32 [00:00<00:03,  7.89it/s]训练:  19%|█▉        | 6/32 [00:00<00:03,  8.30it/s]训练:  22%|██▏       | 7/32 [00:00<00:02,  8.66it/s]训练:  25%|██▌       | 8/32 [00:01<00:02,  8.93it/s]训练:  28%|██▊       | 9/32 [00:01<00:02,  9.09it/s]训练:  31%|███▏      | 10/32 [00:01<00:02,  9.02it/s]训练:  34%|███▍      | 11/32 [00:01<00:02,  8.93it/s]训练:  41%|████      | 13/32 [00:01<00:02,  9.38it/s]训练:  44%|████▍     | 14/32 [00:01<00:01,  9.33it/s]训练:  47%|████▋     | 15/32 [00:01<00:01,  9.17it/s]训练:  50%|█████     | 16/32 [00:01<00:01,  8.99it/s]训练:  53%|█████▎    | 17/32 [00:02<00:01,  8.83it/s]训练:  56%|█████▋    | 18/32 [00:02<00:01,  8.15it/s]训练:  59%|█████▉    | 19/32 [00:02<00:01,  8.13it/s]训练:  62%|██████▎   | 20/32 [00:02<00:01,  8.15it/s]训练:  66%|██████▌   | 21/32 [00:02<00:01,  8.38it/s]训练:  69%|██████▉   | 22/32 [00:02<00:01,  8.64it/s]训练:  72%|███████▏  | 23/32 [00:02<00:01,  8.80it/s]训练:  75%|███████▌  | 24/32 [00:02<00:00,  8.88it/s]训练:  78%|███████▊  | 25/32 [00:02<00:00,  9.13it/s]训练:  81%|████████▏ | 26/32 [00:03<00:00,  8.83it/s]训练:  84%|████████▍ | 27/32 [00:03<00:00,  8.53it/s]训练:  88%|████████▊ | 28/32 [00:03<00:00,  8.49it/s]训练:  91%|█████████ | 29/32 [00:03<00:00,  8.65it/s]训练:  94%|█████████▍| 30/32 [00:03<00:00,  8.76it/s]训练:  97%|█████████▋| 31/32 [00:03<00:00,  8.77it/s]训练: 100%|██████████| 32/32 [00:03<00:00,  8.46it/s]
Epoch 10/10: Train Loss=0.9677, Val Loss=1.0157, Time=5.6s
------------------------------------------------------------

最终测试...
测试集损失: 0.8936

✓ 训练完成!
  最佳验证损失: 0.8983
  测试损失: 0.8936
  模型已保存到: test_results/best_model_real.pt
